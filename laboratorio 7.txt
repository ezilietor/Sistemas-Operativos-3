Comandos usados practica 1

============================================
Server
sudo dnf install nfs-utils -y | Instala nfs
sudo systemctl enable --now nfs-server | Habilitar el servicio 
sudo systemctl start nfs-server   | Habilitar el servicio 
sudo mkdir /OS3   | Crear el directorio donde estaran los archivos
cd /OS3   | Abrir la carpeta 
sudo touch Adrian{1..100}.txt   | Crear 1000 archivos txt
chmod -R  777 /OS3   | Dar todos los permisos al directorio 
ls /OS3    | Comprobar los archivos dentro del directorio 

sudo nano /etc/exports   | Configurar y montar nfs en la maquina del cliente
-----------------------dentro del archivo------------------------
/OS3 IP_Cliente(rw,sync,no_subtree_check)
------------------------------------------------------------------------
sudo exportfs -ra    | Exportar la montura
sudo exportfs -v   | Exportar 
sudo firewall-cmd --permanent --add-service=nfs    | Habilitar los servicios en el firewall
sudo firewall-cmd --permanent --add-service=mountd
sudo firewall-cmd --permanent --add-service=rpc-bind
sudo firewall-cmd --reload

Cliente
sudo dnf install nfs-utils -y       | Instalar nfs en el cliente
sudo mkdir /mnt/OS3          | Crear el directorio que se sincronizara 
sudo mount IP_Server:/OS3 /mnt/OS3      | Montar el directorio del servidor 
ls /mnt/OS3      | Comprobar los archivos 

-----------------Montaje automatico cliente----------


sudo nano /etc/fstab      | Carpeta para que la montura se haga cada vez que se reinicie la maquina


------dentro del archivo-----
IP_Server:/OS3 /mnt/OS3 nfs defaults 0 0
-------------
sudo mount -a      | Montar todo 
ls /mnt/OS3      | Comprobar los archivos

Reiniciar cliente y luego comprobar 



Comandos usados practica 2

============================================


sudo dnf install samba samba-client samba-common -y

sudo mkdir -p /srv/samba/adrian

sudo groupadd sambagrupo

sudo useradd -M -s /sbin/nologin adrianuser -G sambagrupo

sudo smbpasswd -a adrianuser

sudo chown -R adrianuser:sambagrupo /srv/s
amba/adrian

sudo chmod -R 777 /srv/samba/adrian

cd /srv/samba/adrian

touch adrian{1..100}.txt

sudo nano /etc/samba/smb.conf
--------Añadir lo siguiente------------
[AdrianShare]
        path = /srv/samba/adrian
        writable = yes
        read only = no
        browseable = yes
        valid users = adrianuser
        create mask = 0755
        directory mask = 0755
---------------------------

setenforce 0  - Choca con samba y hay que usarlo 

sudo setsebool -P samba_export_all_rw on - Para que SElinux no detenga los permisos

sudo systemctl restart smb

sudo firewall-cmd  --permanent --add-service=samba 

En Windows con la cmd en administrador

net use * /delete

Luego W+R y ahi poner 
\\IP_server

Seleccionar la carpeta compartida y darle a conectar unidad de red


Comandos usados practica 3

============================================
# Descargar git 
sudo dnf install git -y 

#Instalar los plugins para dnf
 sudo dnf -y install dnf-plugins-core
sudo dnf config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo

#Instalar Docker Engine
sudo dnf install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

#Iniciar Docker Engine
sudo systemctl enable --now docker

#Correr el servicio de docker
docker run -d \
  --name samba-dc \
  --hostname dc1 \
  --domainname so3.inet \
  --privileged \
  -p 53:53/tcp -p 53:53/udp \
  -p 88:88/tcp -p 88:88/udp \
  -p 135:135/tcp \
  -p 139:139/tcp \
  -p 389:389/tcp -p 389:389/udp \
  -p 445:445/tcp \
  -p 464:464/tcp \
  -p 636:636/tcp \
  -p 3268:3268/tcp \
  -p 3269:3269/tcp \
  -v samba_data:/var/lib/samba \
  ubuntu:latest \
  tail -f /dev/null

#Entrar al contenedor 
sudo docker exec -it samba-dc /bin/bash

#Instalar samba y tools
apt-get update
DEBIAN_FRONTEND=noninteractive apt-get install -y samba krb5-config winbind smbclient iproute2

#Ejecutar el comando de provision 
rm /etc/samba/smb.conf
samba-tool domain provision --use-rfc2307 --realm=SO3.INET --domain=SO3 --server-role=dc --dns-backend=SAMBA_INTERNAL --adminpass="Admin1234!"

#Antes de crear usuario para contraseña
samba-tool domain passwordsettings set --complexity=off
samba-tool domain passwordsettings set --min-pwd-length=6

#Crear usuario 
useradd lanegracubana

#AÑAdir el usuario al Windows
samba-tool user create lanegracubana 20250863

#arrancar samba 
samba -D

#apagar el firewall 
sudo systemctl stop firewalld

#En el cmd ejecutar 
nslookup so3.inet 10.0.0.17

#Hacer ping a la ip del docker
route -p add 172.17.0.0 mask 255.255.0.0 10.0.0.17

#En el windows
el Dominio: SO3.net
Usuario: Administrator
contraseña: Admin1234!

En pantalla de bloqueo 
Usuario: laanegracubana
contraseña: 20250863

